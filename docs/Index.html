<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Untitled Page</title>
    <script src="jquery-1.10.2.min.js"></script>

    <script type="text/javascript">
var url = "http://html5rocks-cors.s3-website-us-east-1.amazonaws.com/index.html";
        function DeleteFeature() {
            alert("in the function");

            var gisviewerResult = {
                objectId: "6721",
                featureService: "http://gis.bemcorp.net:6080/arcgis/rest/services/NJDOT_Atlas_Development_Features/FeatureServer/0"
            };

            if (gisviewerResult.objectId) {
                var url = "http://gis.bemcorp.net:6080/arcgis/rest/services/NJDOT_Atlas_Development_Features/FeatureServer/0/deleteFeatures"; //gisviewerResult.featureService + "/deleteFeatures";
                var postData = {
                    objectIds: "6721",
                    rollbackOnFailure: true,
                    f: "json"
                };


                //var pp = "[objectIds: " + gisviewerResult.objectId.toString() + ", rollbackOnFailure: true, f: json]";


                //alert(url); alert(postData.objectIds);

                $.support.cors = true;
                var error = "";
                var today = new Date();
                // Show the processing label
                //ShowProcessingAndDisable();  // Comes from the collect input file

                //var postDataJSONString = JSON.stringify(postData);

                //        $.post(url, postData)
                //    .done(function (data, textStatus, jqXHR) {
                //        alert("The feature is successfully deleted for this Inventory");
                //        document.getElementById("ELL_gis_feature_status").value = "false";
                //        document.getElementById("ELL_gis_feature_message").value = "Deleted polygon on " + today.toString(); ;
                //        //document.getElementById("ELL_gis_object_id").value = ""; // Decided to leave the object id in for troubleshooting errors
                //        document.getElementById("ELL_gis_feature_service").value = "";

                //        // Call the update function in PAECETrak
                //        UpdateGISFeature_Script();
                //    })
                //    .fail(function (jqXHR, textStatus, errorThrown) {
                //        alert("The feature could not be deleted for this Inventory. Please contact your administrator.");
                //        //alert(errorThrown);
                //        error = errorThrown;
                //        // Hide the processing label
                //        UndoShowProcessingAndDisable();
                //    });

                $.ajax({
                    type: "POST",
                    url: gisviewerResult.featureService + "/deleteFeatures",
                    data: postData,
                    crossDomain: true,
                    xhrFields: {
                        withCredentials: false
                    },
                    error: function (error) {
                        alert("Error!"); console.log(error);
                        alert("The feature could not be deleted for this Inventory. Please contact your administrator.");
                        // Hide the processing label
                        //UndoShowProcessingAndDisable();
                    },
                    success: function (response) {
                        console.log(response);
                        alert("The feature is successfully deleted for this Inventory");
                        //document.getElementById("ELL_gis_feature_status").value = "false";
                        //document.getElementById("ELL_gis_feature_message").value = "Deleted polygon on " + today.toString(); ;
                        //document.getElementById("ELL_gis_object_id").value = ""; // Decided to leave the object id in for troubleshooting errors
                        //document.getElementById("ELL_gis_feature_service").value = "";

                        // Call the update function in PAECETrak
                        //UpdateGISFeature_Script();
                    }
                });

            }
        }
        function Button1_onclick() {
            //DeleteFeature();
			
			$.ajax({

  // The 'type' property sets the HTTP method.
  // A value of 'PUT' or 'DELETE' will trigger a preflight request.
  type: 'GET',

  // The URL to make the request to.
  url: 'http://html5rocks-cors.s3-website-us-east-1.amazonaws.com/index.html',

  // The 'contentType' property sets the 'Content-Type' header.
  // The JQuery default for this property is
  // 'application/x-www-form-urlencoded; charset=UTF-8', which does not trigger
  // a preflight. If you set this value to anything other than
  // application/x-www-form-urlencoded, multipart/form-data, or text/plain,
  // you will trigger a preflight request.
  contentType: 'text/plain',

  xhrFields: {
    // The 'xhrFields' property sets additional fields on the XMLHttpRequest.
    // This can be used to set the 'withCredentials' property.
    // Set the value to 'true' if you'd like to pass cookies to the server.
    // If this is enabled, your server must respond with the header
    // 'Access-Control-Allow-Credentials: true'.
    withCredentials: false
  },

  headers: {
    // Set any custom headers here.
    // If you set any non-simple headers, your server must include these
    // headers in the 'Access-Control-Allow-Headers' response header.
  },

  success: function() {
    // Here's where you handle a successful response.
  },

  error: function() {
    // Here's where you handle an error response.
    // Note that if the error was due to a CORS issue,
    // this function will still fire, but there won't be any additional
    // information about the error.
  }
});
            return false;
        }
		
		
		
		function JQuery_Call()
		{
		alert("in the function");

            
            
                //var url = "http://html5rocks-cors.s3-website-us-east-1.amazonaws.com/index.html";
				
				 $.get(url)
                    .done(function (data) {
                        alert("The feature is successfully deleted for this Inventory");
                    })
                    .fail(function (errorThrown) {
                        alert("The feature could not be deleted for this Inventory. Please contact your administrator.");
                        alert(errorThrown);
                    });
return false;
		}
		
		// Create the XHR object.
function createCORSRequest(method, url) {
  var xhr = new XMLHttpRequest();
  if ("withCredentials" in xhr) {
    // XHR for Chrome/Firefox/Opera/Safari.
    xhr.open(method, url, true);
  } else if (typeof XDomainRequest != "undefined") {
    // XDomainRequest for IE.
    xhr = new XDomainRequest();
    xhr.open(method, url);
  } else {
    // CORS not supported.
    xhr = null;
  }
  return xhr;
}
	// Make the actual CORS request.
function makeCorsRequest() {
  // This is a sample server that supports CORS.
  var url = 'http://html5rocks-cors.s3-website-us-east-1.amazonaws.com/index.html';

  var xhr = createCORSRequest('GET', url);
  if (!xhr) {
    alert('CORS not supported');
    return;
  }

  // Response handlers.
  xhr.onload = function() {
    var text = xhr.responseText;
    var title = getTitle(text);
    alert('Response from CORS request to ' + url + ': ' + title);
  };

  xhr.onerror = function() {
    alert('Woops, there was an error making the request.');
  };

  xhr.send();
}	
		function XMLHttpRequest_Call()
		{
		
		makeCorsRequest();
		return false;
		}

    </script>

    
</head>
<body>
    <p> <input id="Button1" type="button" value="Ajax Call" onclick="return Button1_onclick()" /></p>
	<p> <input id="Button2" type="button" value="JQuery Call" onclick="return JQuery_Call()" /></p>
	<p> <input id="Button3" type="button" value="XMLHttpRequest Call" onclick="return XMLHttpRequest_Call()" /></p>
</body>
</html>
